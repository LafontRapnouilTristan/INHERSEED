{
  "hash": "5bba0cea63b90a8bab01c41594e21395",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Greenhouse experiment - WP1&2\"\nformat: html\neditor: visual\n---\n\n\n\n\n\n\n# G0\n\nSeeds from XX species were bought from different seed producers. Here is a table listing seed species and origin: [INSERT TABLE]()\n\nWe compiled as much information as possible regarding these species and their seeds. First we looked in the TRY database for available information on these species [REF TRY SECTION](). Additionally, we performed multiple test and measurements on these seeds: \\* Macroscopy and measurements using TRAITOR (REF) [REF MACROSCOPE/TRAITOR SECTION]() \\* Tomography \\* Picnometry \\* Mass measurements \\* Chemistry\n\n### TRY\n\nFirst we identified a set of traits that may be found on the [TRY database](https://www.try-db.org/) [@kattge2019]. TRY requires manual requests and we used R to prepare our requests.\n\n#### Request\n\nFirst check if our species have entries in TRY. Run this only the first time to get the list of TRY species:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# download.file('https://try-db.org/dnld/TryAccSpecies.txt', destfile = \"data/TRY/TryAccSpecies.tsv\", method = \"wget\", extra = \"-r -p --random-wait\", quiet = T)\n```\n:::\n\n\n\n\nThen look for our species:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#get our species list\nspecies_list <- readr::read_tsv(\"data/species_list_INHERSEED.tsv\")\n#check overlap and merge\ntry_sp <- species_list %>%\n  rename(scientific_cleaned = species_for_tree)%>%\n  select(scientific_cleaned) %>%\n  mutate(scientific_cleaned=ifelse(scientific_cleaned==\"Legousia veneris\",\"Legousia speculum-veneris\",scientific_cleaned))%>% #rename that species properly\n  na.omit() %>%\n  unique() %>%\n  left_join(readr::read_tsv(\"data/TRY/TryAccSpecies.txt\"),\n            by = c(\"scientific_cleaned\" = \"AccSpeciesName\")\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntry_sp%>%\n  mutate(is_in_try=ifelse(is.na(AccSpeciesID),\"Not in TRY\",\"In Try\"))%>%\n  ggplot(aes(x=is_in_try,fill=is_in_try))+\n  geom_bar(stat = \"count\")+\n  theme_minimal()+\n  ylab(\"Number of species\")+\n  xlab(\"\")+\n  theme(legend.position = \"none\",\n        text = element_text(face=\"bold\"))+\n  ggtitle(paste0(sum(!is.na(try_sp$AccSpeciesID)),\" species out of \", nrow(try_sp),\" are in TRY\"))\n```\n\n::: {.cell-output-display}\n![Number of our species with values for selected traits in TRY.](01_GreenhouseExp_files/figure-html/fig-speciesinTRY-1.png){#fig-speciesinTRY width=672}\n:::\n:::\n\n\n\n\nNow we can build a request for TRY with our traits of interest. We handpicked from TRY traits list XX traits that were relevant to us.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntry_request <- try_sp%>%\n  summarise(species_list=paste0(AccSpeciesID,collapse = \", \"))\ntry_request%>%\n  readr::write_tsv(\"data/TRY/requests/TryReqSpecies.tsv\")\n\ntraits_try <- readxl::read_xlsx(\"data/TRY/traits_of_interest/Traits repro TRY database.xlsx\")\ntry_request_traits <- traits_try%>%\n  filter(tokeep==\"y\")%>%\n  select(TraitID)%>%\n  summarise(traits_list=paste0(TraitID,collapse = \", \"))\ntry_request_traits%>%\n  readr::write_tsv(\"data/TRY/requests/TryReqTraits.tsv\")\n# 41259 - ID of the first request\n```\n:::\n\n\n\n\nWe requested TRY data access using our species and traits lists.\n\n#### Release\n\nCheck for all the traits the number of value (e.g., species) we have.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntry_release <- readr::read_tsv(\"data/TRY/release/41259_1905202519280_TRY_relaease/41259.txt\")\ntry_release %<>%\n  select(AccSpeciesName, TraitName, StdValue) %>%\n  rename(\n    species = AccSpeciesName,\n    trait = TraitName,\n    value = StdValue\n  ) %>%\n  group_by(species, trait) %>%\n  summarise(value = mean(as.numeric(value), na.rm = TRUE)) %>%\n  tidyr::pivot_wider(values_from = \"value\", names_from = \"trait\")%>%\n  mutate(across(everything(),~ifelse(.x==\"NaN\",NA,.x)))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntry_release%>%\n  reshape2::melt(id.vars=c(\"species\"))%>%\n  group_by(variable)%>%\n  mutate(is_na_var=ifelse(is.na(value),0,1))%>%\n  summarise(pct_species_avail=(sum(is_na_var)/82)*100)%>%\n  ggplot(aes(x=pct_species_avail,y=variable))+\n  geom_point()+\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![% of our species for which we have a value.](01_GreenhouseExp_files/figure-html/fig-traitsinTRY-1.png){#fig-traitsinTRY width=672}\n:::\n:::\n\n\n\n\nWrite the list of traits to a new file.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntry_release%>%\n  reshape2::melt(id.vars=c(\"species\"))%>%\n  group_by(variable)%>%\n  mutate(is_na_var=ifelse(is.na(value),0,1))%>%\n  summarise(pct_species_avail=(sum(is_na_var)/82)*100)%>%\n  filter(pct_species_avail>0)%>%\n  readr::write_tsv(\"data/TRY/release/traits_with_some_values.tsv\")\n```\n:::\n\n\n\n\n## Macroscopy\n\n#### Protocols\n\n#### Image processing\n\n## Tomography\n\n## Picnometry\n\n## Mass measruements\n\n# P1\n\n# G1\n\n# P2\n",
    "supporting": [
      "01_GreenhouseExp_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}